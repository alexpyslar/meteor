<template name="editBookPage">
    {{log this.book}}
    {{#autoForm schema="Schemas.Book" doc=this.book id="updateBookForm"
                type="method" meteormethod="updateBook" validation="blur"}}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Book Edit</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-12">
                        {{> afQuickField name="name" template="bootstrap3-horizontal" label-class="col-sm-2" input-col-class="col-sm-9"}}
                        {{> afQuickField name="genre" template="bootstrap3-horizontal" label-class="col-sm-2" input-col-class="col-sm-9"}}
                        {{> afQuickField name="pageCount" template="bootstrap3-horizontal" label-class="col-sm-2" input-col-class="col-sm-9"}}
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="form-group">
                    <label class="col-sm-2">Author</label>
                    <div class="col-sm-9">
                        {{#afEachArrayItem name='authors'}}
                            {{> authorRow }}
                        {{/afEachArrayItem}}

                        <div class="add-field-link insert-form-decoration">
                            <a class="autoform-add-item" data-autoform-field="authors" href="#">Add another author</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel-footer">
                <button type="submit" class="btn btn-success">Save</button>
                <button type="reset" class="btn btn-link btn-sm">Cancel</button>
            </div>
        </div>
    {{/autoForm}}
</template>


<template name="authorRow">
    {{> afQuickField name=this.current._id label=false style="display:none"}}
    <div class="insert-form-decoration">
        <div class="col-sm-12">
            <div class="col-sm-6">
                {{> afQuickField name=this.current.name label=false}}
            </div>
            <div class="col-sm-6">
                {{> afQuickField name=this.current.year label=false}}
            </div>
        </div>
    </div>
</template>
